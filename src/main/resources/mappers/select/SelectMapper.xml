<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mappers.select.SelectMapper">

<!-- 게시글 투표수 -->
<update id="updateSelect" parameterType="int">
update tbl_board set 
selectcnt = selectcnt +1
where BNO = #{bno}
</update>

<!-- 게시글 투표취소 -->
<update id="updateSelectCancel" parameterType="int">
update tbl_board set 
selectcnt = selectcnt - 1
where BNO = #{bno}
</update>

<!-- 게시글 추천 시 Like 테이블에 insert -->
<insert id="insertSelect">
insert into tbl_select(SNO , BNO , user_id, stype) 
values((SELECT NVL(MAX(sno), 0) + 1 FROM tbl_SELECT) ,#{bno} ,#{userId}, #{stype})
</insert>

<!-- 게시글 추천취소 시 delete -->
<delete id="deleteSelect">
delete from tbl_select where BNO = #{bno} and user_id = #{userId}
</delete>

<!-- 게시글 추천 시 Check를 1로 만들어서 중복방지-->
<update id="updateSelectCheck">
update tbl_select set SELECTCHECK = 1
where BNO = #{bno} and user_id = #{userId}
</update>

<!-- 게시글 추천취소 시 다시 0  -->
<update id="updateSelectCheckCancel">
update tbl_select set SELECTCHECK = 0
where BNO = #{bno} and user_id = #{userId}
</update>

<!-- 게시글 추천 중복방지 select문 -->
<select id="selectCheck" resultType="int">
select count(*) from tbl_select where BNO = #{bno} and user_id = #{userId} 
</select>

<select id="selectType" resultType="com.globalin.domain.SelectVO">
select stype from tbl_select where bno = #{bno} and user_id = #{userId}
</select>

<select id="selectCountCheck" resultType="int">
select count(*) from tbl_select where bno = #{bno} and stype = #{stype}
</select>

<select id="selectAllCount" resultType="int">
select count(*) from tbl_select where bno = #{bno}
</select>

</mapper>