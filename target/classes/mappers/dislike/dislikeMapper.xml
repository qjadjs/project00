<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mappers.like.dislikeMapper">

<!-- 게시글 추천수 -->
<update id="updateDisLike" parameterType="int">
update tbl_board set 
dislikecnt = dislikecnt +1
where BNO = #{bno}
</update>

<!-- 게시글 추천수취소 -->
<update id="updateDisLikeCancel" parameterType="int">
update tbl_board set 
dislikecnt = dislikecnt - 1
where BNO = #{bno}
</update>

<!-- 게시글 추천 시 Like 테이블에 insert -->
<insert id="insertDisLike">
insert into tbl_dislike(DISLIKENO , BNO , user_id) 
values((SELECT NVL(MAX(dislikeno), 0) + 1 FROM tbl_DISLIKE) ,#{bno} ,#{userId})
</insert>

<!-- 게시글 추천취소 시 delete -->
<delete id="deleteDisLike">
delete from tbl_dislike where BNO = #{bno} and user_id = #{userId}
</delete>

<!-- 게시글 추천 시 Check를 1로 만들어서 중복방지-->
<update id="updateDisLikeCheck">
update tbl_dislike set DISLIKECHECK = 1
where BNO = #{bno} and user_id = #{userId}
</update>

<!-- 게시글 추천취소 시 다시 0  -->
<update id="updateDisLikeCheckCancel">
update tbl_dislike set DISLIKECHECK = 0
where BNO = #{bno} and user_id = #{userId}
</update>

<!-- 게시글 추천 중복방지 select문 -->
<select id="DislikeCheck" resultType="int">
select count(*) from tbl_dislike where BNO = #{bno} and user_id = #{userId} 
</select>


</mapper>